# ESO Logs parser

### Disclaimer

“This was created during my time as a student at Code Chrysalis”

### Desciption

![](https://steamcdn-a.akamaihd.net/steam/apps/306130/header.jpg?t=1568643996)

This API is primarily used to look through the logs of a popular MMORPG called Elder Scrolls Online.

While very much a work in progress, the idea is to be able to lookup direct info, from the log files.
Due to the vast amount of data loading and parsing could take some time, so please be patient.

At this moment we can handle only 1 log file at a time. As such, all the data is considered as related to that log.

> Used tech:

- DBMS used is Postgres.
- Queries are handled by GraphQL.
- Server: express-js.

During testing, direct access to most of the data is allowed, meaning it is possible to add/remove/edit data directly using queries.
In the future, it is planned that data etry will be allowed only via actual ESO log uploads.

### Installing Dependencies and Startup

1. Make sure you have a Postgres database available
   //default DB name is set to "esologs"
   //default DB username is set to "postgres"
   If your setup DB differs, please update the `database`, `user`, `password` fields in the `config.js` file of the root folder.

2. Install dependencies by running:

```bash
    yarn
```

3. Run migrations and set up the database by running:

```bash
    yarn migrate
```

- If there were some problems and you need to reset the DB (roll back migrations), use

```bash
    yarn rollback
```

4. To Seed the DB with some initial data , make sure that there is a log file inside the `src_file` folder.
   Please note the size of the file is limited to no more than 15 MB at this point (this might vary depending on the actual amount of data added).
   To seed the db, run:

```bash
    yarn seed
```

With the above steps complete, the setup is done.

### Basic USE

- To start the app run:

```bash
    yarn start
```

- Navigate to `localhost:3000` in your browser to see the overview.
- Navigate to `localhost:3000/graphql` in your browser to test out the queries.

Below you fill find the exposed enpoints that can be used to query and mutate data. The details for available fields can be checked in the structure section.

_Query endpoints:_

- `Logs` - takes no parameters, returns an array of `log` types.
- `ServerLogs` - takes an `server` parameter with a server Name value (partial matching works). Returns an array of `log` elements that match the given parameter.
- `Characters` - takes no parameters. returns an array of all `Character` types from the `player` table.
- `CharactersByType` - takes a `type` parameter with a string value of character type(see structure). returns an array of `Character` types that match criteria.
- `Character` - takes a `character_name` or `character_id` parameter, with a string that matches the name or id. returns the first `Character` type that matches the parameter.

_Mutation endpoints:_
//TBA

### Basic Structure of added elements:

Below you will find a description of the currently added tables and relationships. Editable/Input fields will be marked with a `(*)`.

- _logs:_
  The logs have 4 fields:

  - id - autogenerated on addition
  - log_nr (\*) - a unique log number generated to keep track inside the log file.
    /TO DO: add a link to .the players table to support handling multiple logs
  - server (\*) - the name of the server where the log was created.
    /INFO: The initial seed data has only "NA Megaserver", "EU Megaserver", "PS4 NA Megaserver"
  - date_added - autogenerated on addition

- _players:_
  Although named `player`, this table includes data on everything the game considers a 'Character Unit"
  - id - autogenerated on addition
  - type (\*) - the type of unit
    /INFO: for players - "PLAYER", for other units - "MONSTER"
  - player_nr (\*) - a game generated nr to keep track of units within the log
  - character_name (\*) - the unit name
    /INFO: for players - character name, for monsters - monster name
  - character_id (\*) - the game issued @id
    /INFO: for players - their login ID, for monsters - ""
  - player_identifier - game issued unique hash id.
  - level (\*) - the unit level (Integer)
    /INFO: an integer between 0 and 50
  - cp_rank (\*) - Champion Point rank
    /INFO: an integer value largen than 0;
  - added (\*) - boolean to check whether the unit was Added (T) or removed (F) from the log tracking
  - action_at - a stringified timestamp. Amount of miliseconds from the start of the Encounter log.

### NEXT PLANS:

- create a relationship between a posted log and players being added removed/
- add a SKILLS table
- link skills to players
- add a visual query to the main page (even listener from form that has a fetch??)
- allow uploads from files;

### Additional

For any suggestions, ideas, or fixes, don't hesitate to open an issue or contact me at `igor.m.byak@gmail.com`
